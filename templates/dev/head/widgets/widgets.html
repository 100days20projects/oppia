{% extends "base.html" %}

{% block content %}
<div ng-controller="Widgets" class="container-fluid">
  <div class="row-fluid">
    <br><br>
    <ul class="thumbnails">
      <!-- placeholder for real data on explorations -->
      <li ng-repeat="widget in widgets" class="span4">
        <div class="thumbnail">

          {% if not iframed %}

            <h5><[widget.name]></h5>
            <ul class="nav nav-tabs">
              <li class="active"><a data-toggle="tab" href="#preview-<[$index]>">Preview</a></li>
              <li><a data-toggle="tab" href="#code-<[$index]>">Code</a></li>
            </ul>
            <div class="tab-content">
              <div class="tab-pane active" id="preview-<[$index]>">
                <iframe id="widget-<[$index]>" width="100%" frameborder="0"></iframe>
              </div>
              <!--TODO(sll): make this textarea non-editable.-->
              <div class="tab-pane" id="code-<[$index]>">
                <textarea class="oppia-code" ng-model="widget.raw" rows="10">
                </textarea>
              </div>
            </div>
            {% if admin %}
              <!-- TODO(sll): Implement this. -->
              <button ng-click="editWidget()">Edit this widget</button>
            {% endif %}

          {% else %}

            <h5><[widget.name]></h5>
            <iframe id="widget-<[$index]>" src="" width="100%"></iframe>
            <center>
              <button ng-click="selectWidget(widget)">
                <[widget.name]>
              </button>
            </center>

          {% endif %}

        </div>
      </li>
    </ul>

    {% if not iframed %}
      Add a new widget:
      <form name="addWidget" ng-hide="currentActiveInput == 'addWidget'" ng-submit="createNewWidget()">
        <!--Add error checking here. This cannot be empty.-->
        <input type="text" ng-model="newWidgetName">
        <input type="submit" value="Create Widget">
      </form>

      <div ng-show="activeInputData.name == 'addWidget'">
        <h4>Add code for a new widget
          <button type="button" ng-click="activeInputData.clear()">
            Cancel
          </button>
        </h4>

        <ul class="nav nav-tabs">
          <li class="active"><a data-toggle="tab" href="#code">Code</a></li>
          <li><a data-toggle="tab" href="#preview">Preview</a></li>
        </ul>
        <div class="tab-content">
          <div class="tab-pane active" id="code">
            Add code for a widget:
            <textarea class="oppia-code" ng-model="widgetCode" rows="10">
            </textarea>
            <button type="button" ng-click="saveWidget(widgetCode)">
              Save and Preview
            </button>
          </div>
          <div class="tab-pane" id="preview">
            <iframe id="widgetPreview<[$index]>" width="100%" frameborder="0"></iframe>
          </div>
        </div>
      </div>

     </div>
    {% endif %}
  </div>
</div>
{% endblock %}
