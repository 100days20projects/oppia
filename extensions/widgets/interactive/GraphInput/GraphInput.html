<script type="text/ng-template" id="interactiveWidget/GraphInput">
  <style>
    .oppia-graph-input-viz-container {
      border: 1px solid black;
    }
  </style>
  <div>
    Input graph JSON: <input class='json-graph-input'>
    <button class="btn" ng-click="updateGraphFromInput()">Update Graph</button>
    <button class="btn" ng-click="updateTestGraph()">Use test graph</button>
    <graph-viz></graph-viz>
      <button class="btn btn-default" ng-click="submitGraph()">Submit</button>
    <span ng-show="errorMessage" style="color: red; margin-left: 30px;" aria-live="assertive">
      <[errorMessage]>
    </span>
  </div>
</script>

<script type="text/ng-template" id="response/GraphInput">
  <div></div>
</script>

<script type="text/ng-template" id="graphViz/graphVizSvg">
  <style>
    .oppia-graph-viz-container {
      border: 1px solid black;
    }
  </style>
  <div class='oppia-graph-viz-container'>
    <svg class='oppia-graph-viz-svg' width="100%" height="350" ng-mousemove="mousemoveGraphSVG($event)" ng-click="clickGraphSVG($event)">
      <svg viewBox="0 0 50 350" width="100%" height="350" preserveAspectRatio="xMaxYMin meet">
        <g ng-repeat="button in buttons">
          <rect width="30"
            height="30"
            x="0"
            ng-attr-y="<[20 + 50 * $index]>"
            rx="5"
            ry="5"
            ng-click="setMode(button.mode, $event)"
            ng-attr-style="fill: white; stroke: black; stroke-width: <[(state.currentMode == button.mode) ? 3 : 1]>;">
          </rect>
          <text style="pointer-events: none; font-family: 'Glyphicons Halflings';" x="8" ng-attr-y="<[42 + 50 * $index]>">
            <[button.text]>
          </text>
        </g>
      </svg>
      <g ng-if="graphEditPermissions" ng-repeat="button in graphOptions">
        <rect width="70"
          height="30"
          ng-attr-x="<[10 + 110 * $index]>"
          y="10"
          rx="5"
          ry="5"
          ng-attr-style="stroke: black; fill: white; stroke-width: <[(graph[button.option]) ? 3 : 1]>;"
          ng-click="graph[button.option] = !graph[button.option];">
        </rect>
        <text style="pointer-events: none;" ng-attr-x="<[20 + 108 * $index]>" y="30">
          <[button.text]>
        </text>
      </g>
      <line ng-if="state.addEdgeVertex!=null"
        ng-attr-x1="<[graph.vertices[state.addEdgeVertex].x]>"
        ng-attr-y1="<[graph.vertices[state.addEdgeVertex].y]>"
        ng-attr-x2="<[state.mouseX]>"
        ng-attr-y2="<[state.mouseY]>"
        style="stroke: black; stroke-width: 2;">
      </line>
      <line graph-input-edge 
        ng-repeat="edge in graph.edges"
        ng-click="clickGraphEdge(graph, state)"
        ng-attr-x1="<[graph.vertices[edge.src].x]>"
        ng-attr-y1="<[graph.vertices[edge.src].y]>"
        ng-attr-x2="<[graph.vertices[edge.dst].x]>"
        ng-attr-y2="<[graph.vertices[edge.dst].y]>"
        style="stroke: black; stroke-width: 2;">
      </line>
      <g graph-input-vertex 
        ng-repeat="vertex in graph.vertices"
        ng-attr-transform="translate(<[vertex.x]>, <[vertex.y]>)">
        <text ng-if="graph.isLabeled" 
          x="0" 
          y="-10"
          ng-dblclick="startEditVertexLabel(graph, state)">
          <[vertex.label]>
        </text>
        <circle ng-mouseenter="state.hoverVertex = $index"
          ng-mouseleave="state.hoverVertex = ($index == state.hoverVertex) ? null : state.hoverVertex"
          ng-click="clickGraphVertex(graph, state)"
          ng-mousedown="mousedownGraphVertex(graph, state)"
          ng-mouseup="mouseupGraphVertex(graph,state)"
          ng-dblclick="startEditVertexLabel(graph, state)"
          cx="0"
          cy="0"
          r="5">
        </circle>
      </g>
    </svg>
  </div>
</script>
