<div ng-if="$parent.value.imagePath === ''">
  <schema-based-editor 
    local-value="$parent.$parent.value.imagePath" 
    schema="{type: 'custom', obj_type: 'Filepath'}">
  </schema-based-editor>
</div>
<div ng-if="$parent.value.imagePath !== ''">
  <div>
    <svg class="oppia-image-with-regions-editor-svg"
      ng-attr-width="<[imageWidth]>" 
      ng-attr-height="<[imageHeight]>"
      ng-mousedown="onSvgMouseDown($event)"
      ng-mousemove="onSvgMouseMove($event)"
      ng-mouseup="onSvgMouseUp($event)">
      <image xlink:href="<[getPreviewUrl($parent.$parent.value.imagePath)]>"
        x="0"
        y="0"
        height="100%"
        width="100%">
      </image>
      <rect ng-if="userIsCurrentlyDragging"
        ng-attr-x="<[rectX]>"
        ng-attr-y="<[rectY]>"
        ng-attr-width="<[rectWidth]>"
        ng-attr-height="<[rectHeight]>"
        style="fill: blue; opacity: 0.3;">
      </rect>
      <rect ng-repeat="rect in $parent.$parent.value.imageRegions"
        ng-attr-x="<[rect.region[0][0]]>"
        ng-attr-y="<[rect.region[0][1]]>"
        ng-attr-width="<[rect.region[1][0] - rect.region[0][0]]>"
        ng-attr-height="<[rect.region[1][1] - rect.region[0][1]]>"
        style="fill: blue; opacity: 0.3;">
      </rect>
      <text ng-repeat="region in $parent.$parent.value.imageRegions"
        ng-attr-x="<[region.region[0][0] + REGION_LABEL_OFFSET_X]>"
        ng-attr-y="<[region.region[0][1] + REGION_LABEL_OFFSET_Y]>">
        <[region.label]>
      </text>
    </svg>
    <ul>
    <li ng-repeat="region in $parent.$parent.value.imageRegions">
      <input type="text" ng-model="region.label"></input>
      <button type="button" class="btn btn-default btn-xs" ng-click="deleteRegion($index)">Delete</button>
    </li>
    </ul>
  </div>
  <br><button type="button" class="btn btn-default" ng-click="resetEditor()">Clear Image and Regions</button>
</div>
