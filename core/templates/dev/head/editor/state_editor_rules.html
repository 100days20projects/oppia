<div id="tutorialStateRules">
  <div class="row" ng-repeat="(handlerName, handler) in interactionHandlers">
    <div class="col-lg-2 col-md-2 col-sm-2">
      <ul class="nav nav-stacked nav-pills" role="tablist" ui-sortable="RULE_LIST_SORTABLE_OPTIONS" ng-model="handler">
        <!-- An HTML element marked ui-sortable should contain only one element,
        and this element should have an ng-repeat defined on it. See the
        ui-sortable documentation for more details. -->
        <li ng-repeat="rule in handler track by $index" ng-class="{'active': activeRuleIndex == $index}" class="oppia-rule-block oppia-sortable-rule-block" ng-hide="$last">
          <span class="oppia-rule-sort-handle" ng-if="!$last && handler.length > 2">
            <span class="glyphicon glyphicon-sort oppia-rule-sort-arrows"></span>
          </span>
          <a ng-click="changeActiveRuleIndex($index)" href="#">Rule #<[$index + 1]></a>
        </li>

        <li ng-class="{'active': activeRuleIndex === handler.length - 1}" class="oppia-rule-block">
          <a ng-click="changeActiveRuleIndex(handler.length - 1)" href="#">Default</a>
        </li>
      </ul>

      <div ng-if="getCurrentInteractionId() !== 'Continue' && editabilityService.isEditable()">
        <button type="button" class="btn btn-default btn-lg oppia-add-rule-button protractor-test-add-rule" ng-click="openAddRuleModal()">
          Add Rule
        </button>
      </div>
    </div>

    <div class="col-lg-10 col-md-10 col-sm-10">
      <div ng-repeat="rule in handler track by $index" class="tab-pane" ng-show="activeRuleIndex == $index">
        <rule-editor rule="rule" num-rules="handler.length" answer-choices="answerChoices" interaction-handler-specs="interactionHandlerSpecs" save-rule="saveRule" delete-rule="deleteRule(handlerName, $index)" is-editable="editabilityService.isEditable()">
        </rule-editor>
      </div>
    </div>
  </div>
</div>

<script type="text/ng-template" id="modals/addRule">
  <div class="modal-header">
    <h3>Add Rule</h3>
  </div>

  <div class="modal-body">
    <rule-description-editor current-rule-description="currentRuleDescription" current-rule-definition="currentRuleDefinition" interaction-handler-specs="interactionHandlerSpecs" answer-choices="answerChoices" class="protractor-test-temporary-rule"></rule-description-editor>
  </div>

  <div class="modal-footer">
    <button class="btn btn-default" ng-click="cancel()">Cancel</button>
    <button class="btn btn-success" ng-click="addNewRule()">Add New Rule</button>
  </div>
</script>
