{% extends "editor/state_editor_row.html" %}

{% block label %}interaction{% endblock %}

{% block cls %}oppia-interactive-widget-display{% endblock %}

{% block center %}
  <div ng-if="!hasLoaded" class="oppia-align-center">
    Loading
    <span class="oppia-loading-dot-one">.</span>
    <span class="oppia-loading-dot-two">.</span>
    <span class="oppia-loading-dot-three">.</span>
  </div>

  <div ng-if="hasLoaded">
    <div ng-if="!interactiveWidgetEditorIsShown" class="oppia-interactive-section oppia-editable-section" ng-click="showInteractiveWidgetEditor()" ng-if="editabilityService.isEditable()" ng-disabled="!hasLoaded">
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12">
          <h3 class="oppia-state-editor-section-heading">Interaction <span class="glyphicon glyphicon-pencil oppia-editor-pencil" title="Edit State Name"></span></h3>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12">
          <div angular-html-bind="widgetPreviewHtml" class="oppia-interaction-preview well"></div>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12">
          <div ng-if="showInteractiveWidgetUsageHint"
               class="oppia-interactive-hint">
            <button type="button" class="btn btn-default btn-xs pull-right" ng-click="dismissInteractiveWidgetUsageHint()">
              <span class="glyphicon glyphicon-remove" title="Dismiss Hint"></span>
            </button>
            <p>
              You've just submitted an answer, as a learner would!
            </p>
            <p>
              If you want to edit this form instead, just click the 'Edit Interaction' button above.
            </p>
          </div>
        </div>
      </div>
    </div>

    <div ng-if="interactiveWidgetEditorIsShown" class="oppia-interactive-widget-editor">
      <form class="form-inline" role="form">
        <span class="pull-right oppia-widget-selector">
          Widget type:
          <select class="form-control" ng-model="tmpWidgetId" ng-options="widget_id as widget.name for (widget_id, widget) in allInteractiveWidgets" ng-change="setNewTmpWidget(tmpWidgetId, {})"></select>
        </span>
      </form>

      <h3>Customize Interaction</h3>
      <br>

      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12">
          <div ng-if="isEmpty(tmpWidget.customization_args)">
            <em>There are no customization options for this interaction.</em>
          </div>
          <div ng-if="!isEmpty(tmpWidget.customization_args)">
            <form name="form.schemaForm" class="protractor-test-widget-args">
              <div ng-repeat="customizationArg in tmpWidget.customization_args">
                <span><[customizationArg.description]></span>
                <div>
                  <schema-based-editor local-value="customizationArg.value" schema="customizationArg.schema">
                  </schema-based-editor>
                  <div style="margin-bottom: 15px;"></div>
                </div>
              </div>
            </form>
          </div>

          <hr>

          <div class="checkbox">
            <label>
              <input type="checkbox" ng-model="stateWidgetStickyService.displayed" ng-disabled="!editabilityService.isEditable()">
              Reuse the previous state's interaction, if possible.
              <a href="https://code.google.com/p/oppia/wiki/InteractiveWidgets#Other_options" target="_blank">
                <span class="glyphicon glyphicon-question-sign"></span>
              </a>
            </label>
          </div>
        </div>
      </div>
    </div>

    <div class="row" style="margin-top: 5px;">
      <div class="col-lg-12 col-md-12 col-sm-12">
        <span ng-if="tmpWidget">
          <button type="button" class="btn btn-success protractor-test-save-interaction" ng-click="saveInteractiveWidget(tmpWidget)" ng-disabled="form.schemaForm.$invalid">
            Save Customizations
          </button>
          <button type="button" class="btn btn-default" ng-click="resetInteractiveWidgetEditor()">
            Cancel
          </button>
        </span>
      </div>
    </div>
  </div>
{% endblock %}