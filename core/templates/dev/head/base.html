<!DOCTYPE html>
<html ng-app="oppia">
  <head>
    <meta charset=utf-8>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Oppia - {% block subtitle %}{% endblock %}</title>

    {% block header_css %}
      {% include 'header_css_libs.html' %}
    {% endblock header_css %}

    <script>
      var GLOBALS = {
        csrf_token: JSON.parse('{{csrf_token|js_string}}'),
        INVALID_NAME_CHARS: JSON.parse('{{INVALID_NAME_CHARS|js_string}}'),
        EXPLORATION_STATUS_PRIVATE: JSON.parse(
          '{{EXPLORATION_STATUS_PRIVATE|js_string}}'),
        EXPLORATION_STATUS_PUBLIC: JSON.parse(
          '{{EXPLORATION_STATUS_PUBLIC|js_string}}'),
        EXPLORATION_STATUS_PUBLICIZED: JSON.parse(
          '{{EXPLORATION_STATUS_PUBLICIZED|js_string}}')
      };
    </script>

    {% block header_js %}
      {% include 'header_js_libs.html' %}
    {% endblock header_js %}
  </head>

  <body ng-controller="Base" onload="onBodyLoad()">
    <div id="wrapper">
      <div class="oppia-main-body">
        {% if not iframed %}
          <!-- nav bar -->
          <div class="navbar navbar-static-top">
            <div class="navbar-inner">
              <div class="container">
                <a href="#" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </a>

                <a class="brand" href="/">
                  Oppia&nbsp;<sup>beta</sup>
                </a>

                <div class="nav-collapse collapse">
                  <ul class="nav">
                    <li {% if nav_mode == 'learn' %}class="active"{% endif %}>
                      <a href="/learn">Learn</a>
                    </li>
                    {% if user_email %}
                      <li {% if nav_mode == 'contribute' %}class="active"{% endif %}>
                        <a href="/contribute">Contribute</a>
                      </li>
                    {% endif %}
                    <li {% if nav_mode == 'about' %}class="active"{% endif %}>
                      <a href="/about">About</a>
                    </li>
                    <li {% if nav_mode == 'contact' %}class="active"{% endif %}>
                      <a href="/contact">Contact</a>
                    </li>
                  </ul>

                  <ul class="nav pull-right">
                    {% if user_email %}
                      <li {% if nav_mode == 'profile' %} class="active" {% endif %}>
                        <a href="/profile">Profile</a>
                      </li>
                      <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                          {% if username %}
                            {{username}}
                          {% else %}
                            {{user_email}}
                          {% endif %}
                          {% if is_admin %} (Admin) {% endif %}
                          <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                          <li>
                            <a href="{{logout_url}}">Logout</a>
                          </li>

                          {% if is_admin %}
                            <li class="dropdown">
                              <a href="/admin" target="_blank">
                                Admin Page
                              </a>
                            </li>
                          {% endif %}
                        </ul>
                      </li>
                    {% else %}
                      <li>
                        <a href="{{login_url}}">Login</a>
                      </li>
                    {% endif %}
                  </ul>
                </div>

              </div>
            </div>
          </div>
        {% endif %}

        <div ng-cloak>
          <div class="oppia-alert-blocks">
            <div ng-repeat="warning in (warningsData.warnings | limitTo:5) track by $index">
              <p class="alert alert-block">
                <button type="button" class="close" ng-click="warningsData.deleteWarning($index)">&times;</button>
                <strong>Warning!</strong>
                <[warning]>
              </p>
            </div>
          </div>

          <div ng-show="loadingMessage" class="oppia-loading-fullpage">
            <center>
              <[loadingMessage]>
              <span class="oppia-loading-dot-one">.</span>
              <span class="oppia-loading-dot-two">.</span>
              <span class="oppia-loading-dot-three">.</span>
            </center>
          </div>
          <div ng-show="!loadingMessage">
            {% block content %}{% endblock %}
          </div>
        </div>
      </div>

      {% if not iframed %}
        <div class="oppia-footer">
          <div class="container">
            <ul class="nav">
              <li>
                <a href="/">Home</a>
              </li>
              <li>
                <a href="/learn">Learn</a>
              </li>
              {% if user_email %}
                <li>
                  <a href="/contribute">Contribute</a>
                </li>
              {% endif %}
              <li>
               <a href="/about">About</a>
              </li>
              <li>
                <a href="/contact">Contact</a>
              </li>
            </ul>
          </div>
        </div>
      {% endif %}
    </div>

    {% include 'footer_js_libs.html' %}
    {% include 'rte_js_libs.html' %}

    <script>
      {{ include_js_file('app.js') }}
      {{ include_js_file('directives.js') }}
      {{ include_js_file('filters.js') }}
      {{ include_js_file('services/activeInputData.js') }}
      {{ include_js_file('services/warningsData.js') }}
      {{ include_js_file('services/messengerService.js') }}
      {{ include_js_file('components/autocomplete.js') }}
      {{ include_js_file('components/richTextEditor.js') }}
      {{ include_js_file('components/visualizations.js') }}
      {{ include_js_file('base.js') }}
    </script>

    {% block footer_js %}
    {% endblock footer_js %}

  </body>
</html>
