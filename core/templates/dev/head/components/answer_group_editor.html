<script type="text/ng-template" id="inline/answer_group_editor">
  <div style="height: 100%;">
    <!-- For the default answer group, 'rules' is null. Otherwise, 'rules' is a list of rules. -->
    <div ng-if="rules">
      <strong>
        If the learner's answer...
      </strong>
      <ul class="nav nav-stacked nav-pills" role="tablist" ng-model="rules">
        <li ng-repeat="rule in rules" ng-class="{'active': activeRuleIndex === $index}" class="oppia-rule-block oppia-sortable-rule-block protractor-test-rule-block" style="margin-top: 0;" ng-style="$last ? {'border-bottom': '1px solid #ccc'} : {}">
          <a ng-click="openRuleEditor($index)" ng-hide="activeRuleIndex === $index" class="oppia-rule-tab protractor-test-answer-tab" ng-class="{'oppia-rule-tab-disabled': !isEditable}">
            <div class="oppia-rule-header">
              <span ng-if="$index > 0">or</span>
              <span ng-if="getCurrentInteractionId() !== 'MultipleChoiceInput' && $index !== activeRuleIndex">
                <[rule | parameterizeRuleDescription:getCurrentInteractionId():answerChoices]>...
              </span>
              <span ng-if="getCurrentInteractionId() === 'MultipleChoiceInput'">
                <span class="oppia-multiple-choice-rule" angular-html-bind="rule | parameterizeRuleDescription:getCurrentInteractionId():answerChoices"></span>...
              </span>
            </div>
          </a>
          <span ng-if="isEditable && rules.length > 1"
                class="oppia-delete-rule-button oppia-transition-200 protractor-test-delete-answer"
                ng-click="deleteRule($index)">
            <i class="material-icons md-18">&#xE5CD;</i>
          </span>

          <div ng-if="activeRuleIndex === $index">
            <div class="oppia-editor-card-section">
              <div class="oppia-rule-body-container">
                <rule-editor rule="rule" is-editable="isEditable" is-editing-rule-inline="true" on-cancel-rule-edit="cancelActiveRuleEdit()" on-save-rule="saveRules()" class="protractor-test-answer-body">
                </rule-editor>
              </div>
            </div>
          </div>
        </li>
      </ul>

      <button type="button" ng-if="isEditable" class="btn btn-default btn-lg oppia-add-rule-button protractor-test-add-answer" ng-click="addNewRule()">
        + Add Another Possible Answer
      </button>
    </div>

    <br ng-if="rules">

    <outcome-editor is-editable="isEditable"
                    on-save-dest="getOnSaveAnswerGroupDestFn()"
                    on-save-feedback="getOnSaveAnswerGroupFeedbackFn()"
                    outcome="outcome">
    </outcome-editor>
  </div>
</script>

<script type="text/ng-template" id="rules/outcomeFeedbackEditor">
  <div class="oppia-rule-edit-feedback protractor-test-feedback-bubble">
    <div class="oppia-rule-details-header">
      <strong>Oppia tells the learner...</strong>
    </div>
    <span ng-if="feedback.length == 0">
      <em>No feedback specified.</em>
    </span>

    <schema-based-editor schema="OUTCOME_FEEDBACK_SCHEMA" local-value="outcome.feedback[0]">
    </schema-based-editor>
  </div>
</script>

<script type="text/ng-template" id="rules/outcomeDestinationEditor">
  <div class="form-inline protractor-test-dest-bubble" style="margin-bottom: 10px;">
    <div class="oppia-rule-details-header">
      <strong>And afterwards, directs the learner to...</strong>
    </div>
    <div class="form-group" style="font-size: 1.1em;">
      <span>
        <select class="form-control" ng-model="outcome.dest" ng-options="choice.id as choice.text for choice in destChoices" style="width: 200px;" ng-change="onDestSelectorChange()">
        </select>
      </span>
    </div>
    <ng-form name="newStateNameForm">
      <span ng-if="isCreatingNewState(outcome)">
        <input type="text" focus-on="newStateNameInputField" name="newStateName" ng-model="outcome.newStateName" class="form-control protractor-test-add-state-input" tabindex="0" aria-invalid="false" ng-pattern="newStateNamePattern" required>
      </span>
      <p ng-show="newStateNameForm.newStateName.$error.pattern" class="help-block oppia-form-error" style="font-size: 0.85em;">Please pick a card name consisting of alphanumeric characters, spaces and/or hyphens.</p>
    </ng-form>
  </div>
</script>
